{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "indicator",
  "description": "The Indicator object is a STIX TLO that uses the CybOX patterning grammar to describe something (as a general expression or exact match) that you might see or should look for and includes an assertion of what it means if you see it.",
  "type": "object",
  "allOf": [
    {
      "$ref": "../common/core.json"
    },
    {
      "$ref": "../common/descriptive-properties.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The type of this object, which MUST be the literal `indicator`",
          "enum": ["indicator"]
        },
        "kinds_of_indicator": {
          "type": "array",
          "description": "Specifies the types for this indicator.",
          "items": { "$ref": "#definitions/indicator-kind-cv" }
        },
        "kinds_of_indicator_ext": {
          "type": "array",
          "description": "Specifies the types for this indicator in an extended vocabulary.",
          "items": { "$ref": "../common/vocab-ext.json" }
        },
        "start_time": {
          "$ref": "../common/timestamp.json",
          "description": "The start time for which this indicator is valid"
        },
        "end_time": {
          "$ref": "../common/timestamp.json",
          "description": "The end time for which this indicator is valid"
        },
        "pattern": {
          "type": "string",
          "description": "The CybOX pattern expression that, when matched, means this indicator has been detected."
        },
        "confidence": {
          "$ref": "../common/confidence.json",
          "description": "Confidence that when the pattern for this indicator is matched, the associated context is present"
        },
        "confidence_ext": {
          "$ref": "../common/vocab-ext.json",
          "description": "Confidence that when the pattern for this indicator is matched, the associated context is present, using a third-party vocabulary"
        }
      }
    }
  ],
  "required": ["pattern", "kinds_of_indicator", "confidence"],
  "definitions": {
    "indicator-kind-cv": {
      "type": "string",
      "enum": [
        "anomalous-activity",
        "anonymization",
        "command-and-control",
        "compromised",
        "malicious-activity",
        "watchlist",
        "other"
      ]
    }
  }
}
