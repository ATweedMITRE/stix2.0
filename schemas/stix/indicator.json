{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "indicator",
  "description": "The Indicator object is a STIX TLO that uses the CybOX patterning grammar to describe something (as a general expression or exact match) that you might see or should look for and includes an assertion of what it means if you see it.",
  "type": "object",
  "allOf": [
    {
      "$ref": "../common/core.json"
    },
    {
      "$ref": "../common/descriptive-properties.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The type of this object, which MUST be the literal `indicator`",
          "enum": ["indicator"]
        },
        "labels": {
          "type": "array",
          "description": "Specifies the types for this indicator. Open vocab - indicator-label-cv",
          "items": "string"
        },
        "start": {
          "$ref": "../common/timestamp.json",
          "description": "The start time for which this indicator is valid"
        },
        "start_precision": {
          "$ref": "../common/timestamp-precision.json",
          "description": "The precision of the start timestamp"
        },
        "end": {
          "$ref": "../common/timestamp.json",
          "description": "The end time for which this indicator is valid"
        },
        "end_precision": {
          "$ref": "../common/timestamp-precision.json",
          "description": "The precision of the end timestamp"
        },
        "pattern": {
          "type": "string",
          "description": "The CybOX pattern expression that, when matched, means this indicator has been detected."
        }
      }
    }
  ],
  "required": ["pattern", "labels"],
  "definitions": {
    "indicator-label-cv": {
      "type": "string",
      "enum": [
        "anomalous-activity",
        "anonymization",
        "benign",
        "brute-force",
        "command-and-control",
        "compromised",
        "exfiltration",
        "malicious-activity"
      ]
    }
  }
}
